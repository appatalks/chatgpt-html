<!DOCTYPE html>
<html>
<head>
    <title>Chat GPT</title>
 <script>   
 fetch('./config.json')
  .then(response => response.json())
  .then(config => {
    OPENAI_API_KEY = config.OPENAI_API_KEY;
  }); 
 </script>
    <script src="ChatGPT.js"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.410.0.min.js"></script>
    <style>
        body {
            width: ;
            height: 800px;
            overflow: hidden;
            background-color: rgba(68,70,84);
            color: #fff;
	    margin: 0; /* remove default margins */
	    display: flex; /* enable flexbox layout */
	    align-items: center; /* center elements vertically */
	    justify-content: center; /* center elements horizontally */
    	}
    </style>
</head>

<center>
<body onload="OnLoad()">
    <div id="idContainer">
        <div id="textToSynth">
        <textarea id="txtOutput" rows="10" style="margin-top: 10px; width: 100%; height: 300px" placeholder="Output"></textarea>
	<button class="btn default" onClick="speakText()">Speak This</button>
	<p id="result"></p>
	</div>

<audio id="audioPlayback" controls>
<source id="audioSource" type="audio/mp3" src="">
</audio>

<script>
// Initialize the Amazon Cognito credentials provider
fetch('./config.json')
  .then(response => response.json())
  .then(config => {
    // Initialize the Amazon Cognito credentials provider
    AWS.config.region = config.AWS_REGION;
    AWS.config.credentials = new AWS.Credentials(config.AWS_ACCESS_KEY_ID, config.AWS_SECRET_ACCESS_KEY);
  });

    // Function invoked by button click
    function speakText() {
        // Create the JSON parameters for getSynthesizeSpeechUrl
        var speechParams = {
            OutputFormat: "mp3",
            SampleRate: "16000",
            Text: "",
            TextType: "text",
            VoiceId: ""
        };
        speechParams.Text = document.getElementById("txtOutput").value;
	speechParams.VoiceId = document.getElementById("selVoice").value;
        // Create the Polly service object and presigner object
        var polly = new AWS.Polly({apiVersion: '2016-06-10'});
        var signer = new AWS.Polly.Presigner(speechParams, polly);
        // Create presigned URL of synthesized speech file
	signer.getSynthesizeSpeechUrl(speechParams, function(error, url) {
    if (error) {
        document.getElementById('result').innerHTML = error;
    } else {
        document.getElementById('audioSource').src = url;
        document.getElementById('audioPlayback').load();
        document.getElementById('result').innerHTML = "Speech ready to play.";
    }
});
}
</script>
<p>

<textarea id="txtMsg" rows="5" wrap="soft" style="width: 750px; margin-left: 3px; margin-top: 6px" placeholder="Input Text"></textarea>
        <div>
            <button type="button" onclick="Send()" id="btnSend">Send</button>
            <select id="selModel">
                <option value="text-davinci-003">text-davinci-003</option>
                <option value="text-davinci-002">text-davinci-002</option>
                <option value="code-davinci-002">code-davinci-002</option>
            </select>
	    <select id="selLang" onchange="ChangeLang(this)"> 
		<!-- >
                <option value="en-US">English</option>
		<option value="ko-KR">Korean</option> 
		-->
            </select> 
            <select id="selVoice" onchange="ChangeLang(this)">
                <option value="Seoyeon">Korean</option>
                <option value="Salli">English</option>
            </select>
	</div>

<div id="idText"></div>
</div>

</body>
</center>
</html>
